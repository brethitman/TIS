<div class="max-w-4xl mx-auto px-4">
  <!-- Cabecera -->
  <div class="bg-gradient-to-r from-red-600 via-purple-800 to-blue-600 py-5 mb-8">
    <h1 class="text-white font-bold text-2xl">SELECCIÓN DE ÁREA Y CATEGORÍA</h1>
  </div>

  <!-- Contenido principal -->
  <div class="bg-white p-6 rounded-lg shadow-sm">
    <!-- Estado de carga -->
    <div *ngIf="isLoading" class="text-center py-8">
      <i class="fas fa-spinner fa-spin fa-2x text-blue-500"></i>
      <p class="mt-2">Cargando áreas disponibles...</p>
    </div>

    <!-- Selector de área -->
    <div *ngIf="!isLoading">
      <h2 class="text-xl font-bold mb-4">Seleccione el Área</h2>

      <select [(ngModel)]="selectedAreaId" (change)="onAreaChange()" class="w-full p-3 border border-gray-300 rounded mb-4" required>
        <option [ngValue]="null" disabled>-- Seleccione un área --</option>
        <option *ngFor="let area of areas" [value]="area.id">{{ area.nombre_area }}</option>
      </select>
    </div>

    <!-- Área seleccionada -->
    <div *ngIf="selectedArea" class="bg-[#0A056D] p-6 rounded-lg shadow-lg text-white mb-6">
      <div class="space-y-2">
        <h3 class="text-xl font-bold">{{ selectedArea.nombre_area }}</h3>
        <p class="text-sm">{{ selectedArea.descripcion || 'No hay descripción disponible' }}</p>
      </div>
    </div>

    <!-- Categorías/Niveles -->
    <div *ngIf="selectedArea && !loadingNiveles">
      <h4 class="text-md font-semibold text-gray-700 mb-3">Seleccione una categoría</h4>

      <div *ngIf="niveles.length > 0; else noNiveles" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div
          *ngFor="let nivel of niveles"
          (click)="selectNivel(nivel)"
          [class.border-blue-500]="selectedNivelId === nivel.id"
          [class.border-2]="selectedNivelId === nivel.id"
          class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm cursor-pointer transition-all hover:shadow-md">

          <!-- Encabezado -->
          <div class="bg-[#6E64C9] p-3 text-white">
            <h3 class="font-semibold">{{ nivel.nombre_nivel }}</h3>
          </div>

          <!-- Detalles -->
          <div class="p-3">
            <p class="text-sm"><span class="font-medium">Descripción:</span> {{ nivel.descripcion || 'Sin descripción' }}</p>
            <p class="text-sm"><span class="font-medium">Fecha examen:</span> {{ nivel.fecha_examen | date:'dd/MM/yyyy' || 'Por definir' }}</p>
          </div>
        </div>
      </div>

      <ng-template #noNiveles>
        <p class="text-gray-500 text-sm italic py-4">No hay categorías disponibles para esta área.</p>
      </ng-template>
    </div>

    <!-- Botones -->
    <div class="flex justify-between mt-8">
      <button (click)="volver()" class="px-6 py-2 bg-gray-500 text-white rounded">
        Anterior
      </button>

      <button
        (click)="finalizarInscripcion()"
        [disabled]="!selectedNivelId || isSaving"
        class="px-6 py-2 bg-green-600 text-white rounded disabled:bg-gray-400">
        <span *ngIf="!isSaving">Finalizar Inscripción</span>
        <span *ngIf="isSaving">Procesando...</span>
      </button>
    </div>
  </div>
</div>
